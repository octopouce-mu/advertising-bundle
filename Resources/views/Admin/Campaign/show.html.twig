{% extends '@OctopouceAdvertising/Admin/layout.html.twig' %}

{% block title %}Campaign {{ campaign.id }} - {{ parent() }}{% endblock %}

{% block main %}
    <section class="padding-filter">
        <div class="row title">
            <div class="col s12">
                <h1>
                    Campaign : {{ campaign.name }}
                    {% if campaign.isActive %}
                        <a href="{{ path('octopouce_advertising_admin_campaign_edit', {'campaign':campaign.id}) }}" class="waves-effect waves-light btn orange"><i class="fas fa-pencil-alt"></i></a>
                        <a href="{{ path('octopouce_advertising_admin_campaign_delete', {'campaign':campaign.id}) }}" class="waves-effect waves-light btn red"><i class="fas fa-times"></i></a>
                    {% endif %}
                    <span class="right" id="reportrange"><i class="fa fa-calendar"></i>&nbsp;<span></span> <i class="fa fa-caret-down"></i></span>
                </h1>
            </div>
        </div>
        {% include '@OctopouceAdvertising/Admin/Common/statistics-day.html.twig' with {'clicks': stats.clicks, 'impressions' : stats.impressions} %}
        <div class="row">
            <div class="col s12">Pages with adzones and adverts</div>
            {% for page in pages %}
                <div class="col s6 m6 l2">
                    <div class="box">
                        <div class="title">{{ page.name }}</div>
                        <div class="content">
                            {% for adzone in page.adzones %}
                                {% set advertInAdzone = false %}
                                {% for advert in adzone.adverts %}
                                    {% if advert.campaign == campaign %}
                                        <div class="box">
                                            <div class="bg-img" style="background-image: url('{{ asset(advert.imageDesktop.pathname) }}');"></div>
                                            <div class="content">
                                                <b><a href="{{ path('octopouce_advertising_admin_advert_show', {'advert':advert.id}|merge(app.request.query)) }}">{{ advert.name }}</a></b>
                                                <span class="right"><a href="{{ path('octopouce_advertising_admin_advert_unlink', {'advert': advert.id, 'adzone':adzone.id}) }}" onclick="return confirm('Are you sure to unlink advert and adzone ?');"><i class="fas fa-unlink"></i></a></span><br>
                                                Adzone : {{ adzone.name }}
                                            </div>
                                        </div>
                                        {% set advertInAdzone = true %}
                                    {% endif %}
                                {% endfor %}
                                {% if not advertInAdzone and campaign.isActive %}
                                    <div class="box">
                                        <div class="content">
                                            <a href="{{ path('octopouce_advertising_admin_advert_create', {'campaign':campaign.id, 'adzone':adzone.id}) }}">Add advert in the adzone "{{ adzone.name }}"</a>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </section>
{% endblock %}