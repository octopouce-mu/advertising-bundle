{% extends 'admin/layout.html.twig' %}

{% block main %}
    <section class="padding-filter">
        <div class="row title">
            <div class="col s12">
                <h1>
                    Campaign : {{ campaign.name }}
                    {% if campaign.endDate|date('U') > 'now'|date('U') %}
                        <a href="{{ path('octopouce_advertising_admin_campaign_edit', {'campaign':campaign.id}) }}" class="waves-effect waves-light btn orange"><i class="fas fa-pencil-alt"></i></a>
                        <a href="{{ path('octopouce_advertising_admin_campaign_delete', {'campaign':campaign.id}) }}" class="waves-effect waves-light btn red"><i class="fas fa-times"></i></a>
                    {% endif %}
                    <span class="right">{{ campaign.startDate|date('d/m/Y') }} - {{ campaign.endDate|date('d/m/Y') }}</span>
                </h1>
            </div>
        </div>
        <div class="row">
            <div class="col s12">Pages with adzones and adverts</div>
            {% for page in pages %}
                <div class="col s6 m6 l2">
                    <div class="box">
                        <div class="title">{{ page.name }}</div>
                        <div class="content">
                            {% for adzone in page.adzones %}
                                {% set advertInAdzone = false %}
                                {% for advert in adzone.adverts %}
                                    {% if advert.campaign == campaign %}
                                        <div class="box">
                                            <div class="bg-img" style="background-image: url('{{ asset(advert.imageDesktop) }}'); background-size: cover; width: 100%; height: 100%;position: absolute; opacity: .2;"></div>
                                            <div class="content">
                                                <b><a href="{{ path('octopouce_advertising_admin_advert_show', {'advert':advert.id}) }}">{{ advert.name }}</a></b><br>
                                                {{ advert.totalViews }} view(s) | {{ advert.totalClicks }} click(s) <br>
                                                Adzone : {{ adzone.name }}
                                            </div>
                                        </div>
                                        {% set advertInAdzone = true %}
                                    {% endif %}
                                {% endfor %}
                                {% if not advertInAdzone and campaign.endDate|date('U') > 'now'|date('U') %}
                                    <div class="box">
                                        <div class="content">
                                            <a href="{{ path('octopouce_advertising_admin_advert_create', {'campaign':campaign.id, 'adzone':adzone.id}) }}">Add advert in the adzone "{{ adzone.name }}"</a>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </section>
{% endblock %}